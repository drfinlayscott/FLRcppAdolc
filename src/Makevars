## Use the R_HOME indirection to support installations of multiple R version
PKG_CPPFLAGS = -I../inst/include -I../inst/include/adolc
PKG_CFLAGS = -I../inst/include -I../inst/include/adolc
##PKG_LIBS = $(SUBLIBS) `$(R_HOME)/bin/Rscript -e "Rcpp:::LdFlags()"`
PKG_LIBS =`$(R_HOME)/bin/Rscript -e "Rcpp:::LdFlags()"` $(SUBLIBS) 
## As an alternative, one can also add this code in a file 'configure'
##
##    PKG_LIBS=`${R_HOME}/bin/Rscript -e "Rcpp:::LdFlags()"`
## 
##    sed -e "s|@PKG_LIBS@|${PKG_LIBS}|" \
##        src/Makevars.in > src/Makevars
## 
## which together with the following file 'src/Makevars.in'
##
##    PKG_LIBS = @PKG_LIBS@
##
## can be used to create src/Makevars dynamically. This scheme is more
## powerful and can be expanded to also check for and link with other
## libraries.  It should be complemented by a file 'cleanup'
##
##    rm src/Makevars
##
## which removes the autogenerated file src/Makevars. 
##
## Of course, autoconf can also be used to write configure files. This is
## done by a number of packages, but recommended only for more advanced users
## comfortable with autoconf and its related tools.

## From Manual
##If you want to create and then link to a library, say using code in a subdirectory, use something like
##
##     .PHONY: all mylibs
##     
##     all: $(SHLIB)
##     $(SHLIB): mylibs
##     
##     mylibs:
##             (cd subdir; make)
#

#SOURCES_C = FLQuant.cpp FLStock.cpp tests_FLQuant.cpp tests_FLStock.cpp RcppExports.cpp 
SOURCES_C = FLQuant_base.cpp tests_FLQuant.cpp tests_FLQuantAdolc.cpp RcppExports.cpp 
OBJECTS = $(SOURCES_C:.cpp=.o)

SUBDIRS = adolc
SUBLIBS = $(SUBDIRS:=.a)

all: $(SHLIB)
$(SHLIB): sublibs $(OBJECTS)

sublibs:
	@make -C adolc -f Makefile library



# Plan
# Compile ADOLC into static library libadolc.a
# ADOLC headers in inst (check)
# ADOLC source in src/adolc
# ADOLC makefile in src/Makefile
#
# Compile other C++ code in src (e.g. Rcpp stuff)
# Link the *.o with libadolc.a into *.so
# # How to them link with the .cpp files in this folder?
#.PHONY: all mylibs

	

